<fieldset #fieldSet class="editable elemblock">
    @if(editable) {
        <legend #legend class="ctrl-elem">{{fullId()}}</legend>
        <div #editPanel class="ctrl-elem spacingbottommedium">
            <div class="spacingbottomsmall">
                <label class="spacingrightsmall" for="titleform-{{id()}}">Change title to:</label>
                <input type="text" id="titleform-{{id()}}" [formControl]="title">
            </div>
            <div>
                <button [disabled]="curRow<0 || curCol<0" (click)="addRowAboveCurrent()">Add row above current</button>
                <button [disabled]="curRow<0 || curCol<0" (click)="addRowBelowCurrent()">Add row below current</button>
                <button [disabled]="alterer.getRows()<2" (click)="removeCurrentRow()">Remove current row</button>
            </div>
            <div>
                <button [disabled]="curRow<0 || curCol<0 || alterer.getCols()>=maxCols" (click)="addColumnLeftOfCurrent()">Add column left of current</button>
                <button [disabled]="curRow<0 || curCol<0 || alterer.getCols()>=maxCols" (click)="addColumnRightOfCurrent()">Add column right of current</button>
                <button [disabled]="alterer.getCols()<2" (click)="removeCurrentColumn()">Remove current column</button>
            </div>
            <div>
                <button [disabled]="widthController.equalDistributed" (click)="widthController.distrubuteColumnsEqually()">Equal column width</button>
            </div>
            <div class="spacingtopsmall" aria-live="polite">{{lockInfo}}</div>
        </div>
    }
    <div class="boxed paddingtopsmall">
        @if(hasTitle() || editable) {
            <div class="paddingleftsmall">
                <h4 class="elemtitle">{{title.value}}</h4>
            </div>
        }
        <table>
            <tbody #tableBody >
                @for(row of alterer.content; track $index; let rowIdx = $index) {
                    <tr>
                        @for(col of row; track $index; let colIdx = $index) {
                            @if(!editable || colIdx != curCol || rowIdx != curRow) {
                                <td [style]="col.widthStyle()">
                                    <input type="text" (focus)="setSelectedCell($event)" (contextmenu)="setAndLockSelectedCell($event)" (input)="fireElemChangedEvent()" [formControl]="col.text">
                                </td>
                            }
                            @else {
                                <td class="current" [style]="col.widthStyle()">
                                    <input type="text" class="current" (focus)="setSelectedCell($event)" (contextmenu)="setAndLockSelectedCell($event)" (input)="fireElemChangedEvent()" [formControl]="col.text">
                                </td>
                            }
                        }
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div #dragContainer class="shifterBox">
        @for(left of widthController.lefts; track left) {
            @if(!$first) {
                <button class="shifter" [style]="left" (cdkDragStarted)="startDraggingShifter($index)" (cdkDragEnded)="widthController.endDraggingShifter()" (cdkDragMoved)="widthController.moveDraggingShifter($event, $index)" cdkDragBoundary=".shifterBox" cdkDragLockAxis="x" cdkDrag>&lt;&gt;</button>
            }
        }
    </div>
    @if(editable) {
        <div class="ctrl-elem flexend spacingbottomsmall spacingtopmedium">
            <button (click)="deleteTable()">Delete table</button>
        </div>
    }
</fieldset>
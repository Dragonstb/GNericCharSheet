<fieldset [class.editable]="editable" class="elemblock">
    @if(editable) {
        <legend #legend class="ctrl-elem">ressource-points-{{elemModel.getId()}}</legend>
        <div class="ctrl-elem spacingbottommedium">
            <div class="spacingbottomsmall">
                <label class="spacingrightsmall" for="titleform-{{elemModel.getId()}}">Change title to:</label>
                <input type="text" id="titleform-{{elemModel.getId()}}" [formControl]="elemModel.title" (input)="fireElemChangeEvent()">
            </div>
            <div>
                <div>
                    <button (click)="modal.openDmgTierConfigModal(elemModel.getTierMap())">Configure damage tiers</button>
                </div>
                <div>
                    <button (click)="addRow()">Add row</button>
                    <button [disabled]="elemModel.getRows().length<2" (click)="removeRow()">Remove row</button>
                </div>
                <div>
                    <button (click)="addCol()">Add column</button>
                    <button [disabled]="elemModel.getPointsPerRow()<2" (click)="removeCol()">Remove column</button>
                </div>
            </div>
            <div class="spacingtopsmall">
                <div>
                    <input type="checkbox" id="showText-{{elemModel.getId()}}" [formControl]="elemModel.showTextsCheckbox" (change)="updateTextVisibility()">
                    <label for="showText-{{elemModel.getId()}}">Show texts</label>
                </div>
                <div>
                    <input type="checkbox" id="absorbDamage-{{elemModel.getId()}}" [formControl]="elemModel.absorbCheckbox" (change)="fireElemChangeEvent()">
                    <label for="absorbDamage-{{elemModel.getId()}}">Higher tiered damage absorbs lower tiered damage</label>
                </div>
            </div>
        </div>
    }
    <div class="boxed">
        @if(hasTitle() || editable) {
            <h4 class="elemtitle paddingleftsmall">{{elemModel.getTitle()}}</h4>
        }
        @if(!editable) {
            <div class="spacingtopmedium spacingbottommedium spacingleftsmall">
                <label class="spacingrightsmall" for="{{elemModel.getId()}}-dmg-input">Damage:</label>
                <input id="{{elemModel.getId()}}-dmg-input" type="text" [formControl]="dmgInput" (input)="onDmgInput()" (keyup.enter)="onSubmitDamage()">
                <svg #checkmark width="15px" height="15px" class="svgokicon hidden"
                    viewBox="0 0 10 10"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:svg="http://www.w3.org/2000/svg">
                    <path
                        style="fill:none;stroke:inherit;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1"
                        d="M 9,1 4,8.7 1,6.2" />
                </svg>
            </div>
        }
        @for(row of elemModel.getRows(); track row.id) {
            @if(elemModel.isTextVisible()) {
                <gneric-rpmrow class="paddingleftsmall thintopborder blockdisplay" [status]="row" [showText]="elemModel.isTextVisible()" [textEditable]="editable" (input)="fireElemChangeEvent()" />
            }
            @else {
                <gneric-rpmrow class="thintopborder blockdisplay" [status]="row" [showText]="elemModel.isTextVisible()" [textEditable]="editable" (input)="fireElemChangeEvent()" />
            }
        }
    </div>
    @if(editable) {
        <div class="ctrl-elem flexend spacingbottomsmall spacingtopmedium">
            <button (click)="fireDeleteRPMEvent()">Delete ressource points</button>
        </div>
    }
</fieldset>
<gneric-dcm #modal (setDmgConfigEvent)="updateDmgConfig($event)" />